/*
 * Source : http://www.cs.ucdavis.edu/~rogaway/papers/seal.pdf
 */
#ifndef SEALTEST_HPP
#define SEALTEST_HPP

#include <gtest/gtest.h>
#include "../src/SEAL.hpp"
#include "../src/Digest.hpp"

class SEALTest : public ::testing::Test
{
protected:
   SEAL *R;

   virtual void SetUp()
   {
      R = new SEAL({0x67, 0x45, 0x23, 0x01, 0xEF, 0xCD, 0xAB, 0x89, 0x98, 0xBA, 0xDC, 0xFE, 0x10, 
              0x32, 0x54, 0x76, 0xC3, 0xD2, 0xE1, 0xF0}, 0x013577AF, 4096);
   }

   virtual void TearDown()
   {
      delete R;
   }
};

TEST_F(SEALTest, generate)
{
   const std::string out = "37A005959B84C49CA4BE1E050673530F5FB097FDF6A13FBD6C2CDECD81FDEE7C2ABDC3E7"
   "64209AFF00A12283EF675085C1634B53289059E6A7AB5ED9480C01EB4C64569A8DCE2A23FEED0EF58F6F5AC3F74145127"
   "DBCAEC4BCB6B1A459BDC28758BA0523F721C3E154433DC7353F02EF487B07AD309EF5E44E6CC19026F5FD5707CC32EC12"
   "B9C01FE0C58BEB2FE73EA79E24093F05911663A76B21BEAB18CEDE17275C54D18FCD3E4CF32279347B22F8751119FB56D"
   "92F55D511E4ECC1334085E74934455A2DAEC3F1821C54B4CB809053B8D837DE4186600AFEDF8BD72DD56E223745C19F76"
   "EDBA01E9B5346666D01F677FBD68FA5010FD7DB8B06829A90DA0E81B84756A70946A6C05E16D225A2E11AF586BB1C5B1D"
   "21F5349F8E5E3EE41F4232D554954D1BC86064754B86C1DC92D7A9DE30086D8EB4A7C86DB9C380F13B952E11C5B89F1BE"
   "0A6B52C6E7A053DA7359C5FD7F50C70232D86AFF08C5FF1746D3BD074D79AD6FC657E0CBBE5D02C4FCE55D3C31FEF4642E"
   "D738F751430F2F1CF6E453EF6EDEB9540CEC52C697D4864201E141E06C3DDF5AAA64A1A984247E96D2CF1E7FB2BC239919"
   "369F4A0BF9D111D0D8BE64AFAE86214D5F62E64F25E8F13E12680EC170AD6234CBBDA938DF53CC17A12AFEA1EB4005122A"
   "65CB42BEDB76EDF029DB910FC81B81F3DD28341FED4064CE37648548E5852D4AEBB7923016F9AFCB07AE7BC11800E217A0"
   "062F0B53FFA8D471AA78CA6A13B7F56471891067730A311D6FE4FF57F05F9A58AA742696B6CBB3EC539DA0C2AADD6A60D2"
   "A33C26D58A343448ED912AAFB98568C6AE1CB1EFAEAFD81A6E3E7C450F8E2BE4C6CC18F95E8A1C6C59190A2798E912A614"
   "C1E7D0F7E74B1BAF8E5682F5442F998B24FA86D1E5F673002E2C92DB8EBF7ABB1C9D267A9763F4BD54F7BBF07C4466DAC0"
   "BF3FFAF5666A43A52F0812E76DF5F9D4DA8ED1BC6D4AB29B34718FACB4BEBC11E907FE9B0E3937DE7769FC5B0CC52B3E50"
   "D57E02B9B4022949AAF3698BC58F696073EC972A425CAEE9700864D3D166130EE09D51320B9D51BC9B4AA575C789786242"
   "0698D9E1F6426FD141A32C9F55C24E5149E274983035AC1C44833B0179AED63EA2B2B61AFA54700155E55C7C343412584F"
   "7B0FE73D63C5AD88718DDE3000AC1DB4050AE2610032E6B389EEC48952A1A2ED0016E525CCD9616706CABA89ED07D54F15"
   "ECFAABBC91B7C82C5904BC0F83D44888997FAA11FE8FA7333CB8C5B16E3152233C80FBC9F71D9EE8FEFA50D67A7E45B93D"
   "3469BA4078BB1ED5859E7A8E62B26BACF538507FA6BD43E18D67D7AAF27BAAA68D233CA392CE33E257D5DDF3FAEF6A9514"
   "30D686F65EE9AFAF6AEE0677B41098922B41FBA202EF05A27D6146125DAEBEB147D617C8DF42DBA0B91DFBF8AB5805EE98"
   "77E495881035FBB7342C24E24F3B85C88671184152AB0D395A9A81AFAB3BF93BEA49CB23EE6BD1C9FB84E64ECD462F6011"
   "9CEEAE7F1D2150BD36FE7EF2782B0FD12B55DF119A517103D4890A739B715D3D33E2AE9FE659DF4BC0136C0B243538EAA8"
   "F9B813043D66AE15C8261C94C0072AFC802668B3151AD1C0AB0F034EB3E8F2FCE0C9FBC8F68404FB93A1CD11F4EB9A5EEB"
   "9117462EA602AE41FBFE0074323E56E15DEB04D41F3510CD1DF417F759F4C2BEE72BAB88833E7D3D9837801F16901EE125"
   "81588FA7037F74073B2166405D79098098FB196CC4B1733E45796FA7FC977CBD23853E5943B2ADE154856565A455189198"
   "F6BA50B9CC6FDA0C309A413CCC746BC8261FD6B060F05CFCC82894125B3F1E0B0C47257FD838CF295AA13102724163A9FC"
   "2598FE8572D0BF844518DCCC1EE16EB8E4C9935B78FB969B7C3104091079079A7688F1E8330335F63EABFDD3224A506BAE"
   "4EA3022A8A4959F4FA410AD7111488A39E3C1CD7A28CE83255DE2C4477FE62F660AF3B7BA049240AA5212E4E9FFFD8B66F"
   "D51B170BDF6C7E7214361A7EFDCEAE86878F49716C0859CE2E24979BAE82D98025720E06D7904C9646F1B1058B1A7C93EE"
   "4FD728C4F19051ADF2CA30F4D54CF65BE23A7198E5BE5765C018BBC1D2344FA8D1AA908CB8F789EA793C6C60D9A7BA9EEB"
   "CF7AEE50A54810CBE3B632144956A157C220E33A232C169CC9AE64D6AA3560A185FC2D94F15B389EEBAD8D07662C2BE6D6"
   "349ECE8EF88AEA27D430EC9512FF1BC0C5560862FA4A833AF750D968E9FB545E3879571EC021735761DA937E294820C658"
   "5AE00E8023F48A4E1F392217DF763A09E540CA615188345512179F8889902F38C626EA3A333FC367818B058DBB8D6AA474"
   "FF3438B2DE2B32822FDB93F7761883B89223E0E616C885FA3414905D098D82A5359F629ED11589974393CFAF4695DA7EE3"
   "6346D088A6EA6EF21AD6245DA8DE9956FCEFC930C4E2759B596E3F98D92483B2BD82B74269CAAE2014F796FFCFE5DB5875"
   "9F0CD4E527B16F989D9CBAB7F20282EE2E666CC19AD64AA7A36193FF248002C762280A98F3AD2BF07B32F26BEFF5A5586D"
   "967D844ABA69F7297BB1E28075273F39AA6E7C6C7308728DA8AD3031A2D20EBE99940732F93D0440B6E3B481774B69EB76"
   "179496350983031C2611A27D885D91AC37DEBC02512EDD06E1D10061325C5E04269C0C14942D10F03F8306EF173D645478"
   "D79C74990A82DF4B13F2754F273227F96988C25BEDAF39253469D73D642305F8058CE4713F65A36B822CD98DA3FD805C44"
   "08D18DDE4EE8E79472E38F8683EDBBFDCE8D085E005407666EEFBA25D8C3368C6CB656A699B3073631B8024EB6859019FE"
   "B76BDB5A0D7F17C92A37FE6BCD14630C1A62BDDE1E41B5E9AB7306183A16C31554821AD44229EBCE2E552F9A09FD1607DE"
   "C8C92A1E893AB80C331CDC7860093503CEDFD44B3403B3501415916303BAEF0C68D12EFA7C54A11AF3A7DF5D23DF98CFBA"
   "907DAFAD0A8989C710D4602FC75F663FB16039D94EF860F358BBF05AC9C34865141030513C4CDA32E9B777D9FD9E4EBDC1"
   "AD0B24F6799F815E29B8E2259F94B0215B94B349938556736D3ED578CDCEA9024D71F174376F05B3C203CC56476DD92D07"
   "ECF7E283CC181225A2B690EEAF3CFFD35BBDA9C4ED0456661E2E39F6BE537D2446F65CAE13A6DEA668B04F8F223601629C"
   "D3D11B75180DFEA19435BAE5E0622C5005371D4198B8DC1E0C40ADBBE08D3651D3454D68507F7F0B56D4BF2A328BB68854"
   "064699D0A38D7468EF64DDB4139644FABBD21AD79B5F28A5612E445DC5673B2038E3F7DCF17A12AB32DA214FB28500EA79"
   "00491554DA45661A03E2A878D1006D4FBA8E22A7E5DDED9B02FB8B5E6D166AAD43F8EF3EEC4A7050A0304D46CC0BE3EC97"
   "F0BDD137EEA7C001BD8519101FF3AF76D1D7710C22C5B0A69C10DF3493283254F5AFA2CE4B3959D3BE512E6DDB78DA30CC"
   "0A338D675C8FC3FCBBD313B696C660A85FA13EC9FA13AC8E8DBCE8335575608D5962ECB516B9AC186206E1FFB971924E93"
   "01E6FC220D0769EA1CD954E2FDDC591EA026E369509D427AD062B81CA5E8873432A0D7A031B7F26702840FBB5E5E9E6C87"
   "94DBEC841822CA92AEA2A22709182A3CDA136B7B3569D85BE621381706B2852B7DE3E20907739958726334AD0C2C3B7327"
   "D0060B3F6CD319BF6666E09DE3EE588ABB948A6DF37D5AC2B18C82D63CA0A0DCC6F1C1E2AE609999F60738714DF767FBF1"
   "4B12B7A002CE0DAD86F8ADF777FF7CCC9B08180FAA0D96B440233CA5398525EAAA9AFBA9E0EA4F2CFBF5A3E868F99DDC1A"
   "86EE36BAF2AB56F9B0B1FF1FF591033E579847267B9557217E0991D2C90E61F7E58321D9BDABA96C9C63E9D3924F0A8C7A"
   "C6D4FC94D74D7BC1A96AAFAD76FCA0FA4017D76F00F5CB5E96058FAFB57CAF07CBCF665FEA359CFA2CD4084796E3EA2CCF"
   "30BBE6E8F7EFEA60190FCF2700D1D27B80FF53D8071AEEE1ED8708617C92D821F83C9A7EA90C72F19A58E9179CBED5F4F8"
   "6A80C28E0FBC3FAC50D5EEA3117DF747AB076044F1EF61C7BB95AB31CA2F4F6E61D19E906230694158DF40A72FB748DD79"
   "D0FD0617B724B23C6D0569D170731EE07DFD637820F10FBE860A179F2A24775B1F27A2E528A5808D13CC3F995D2CF0C4A8"
   "32915E19BD6293BFAE8EEABCF85DE223C4DEA84F0D095815CD34AB885D6C50816BF8FD07D4E58AA8C8FBF34344FC3279C1"
   "EFA14268471FF263F121BC501439C9FE1AE45C946B348A00535AE451D17F3EDCECEA675A7DDE387813246BB8312147163F"
   "813159413FD550E00204C441B0EAF4D12C79520A3D3BD75B00E20A5284457FC3999AC7CE1F1202E5BD651047C74EAC7FF9"
   "2D7F214D6583304F6DDA309A01230198B1E656C9707F2F27663C1855771AF7F4490E3F3F8DA53F0492654A3C40D15620E2"
   "FD2A68658ECAA8FB5601775A393878A3110D75E6B968DB8EB81C2ECBA5852B2EAF7F9B8967B60F92EE4AF138A5E777B7AA"
   "D802E39D7237A17B4A79D9A467A4BE1BE5121DE907400EE5586F0F94BED1DB35DCD7995EC93B49B0F6DC7A1E3E4CC0AD19"
   "45E60DBE0D24948EB94DDBC45E20FE0BEA593DF4E6D38647FB623DF65F6FBD1E36F318DECF77824ABD6BDF95EB8FA5F29B"
   "650F36B77A305BF9C15B034A7CE1F482CCBA079171A6476863A70BF49FCC488177E461837C64D5F5419AE0A344010DF2D6"
   "EDB170B1461EF27024199B1544144DC327EB225F1EE99AB4F07BF2F934042F2DF86252C4058212B2E5CF35DD14DF206C1D"
   "BA5445D41F211911E1053813A09E7FEA3D5DE5CAC92ACFE36B3EF68D4767C52A31C8CCBA0EAA85874892D813AE601DB1FF"
   "D5CD42EC1E98534056E2753B5FA30F993016B787DE9620A1242986370E005FF4495315C2B1AEDB59A32E47BE953EA41F15"
   "FBE7A115D10328F67E59C538948CEEF3F4A338A030AD198B2FC89F067B336F28085A4CA061A38AE6190DE48981DE1C942E"
   "A83A9143B1FAF94C2F462A9DE5D14B915BFC52E916D16F11CF59A28A3D933FEDB48AC06B7CDD29A0720ED851863BAFE7A1"
   "49F403881AFE46B940CA37C29B7E49A730B2840417944973274553B70FB11DA65ACC1C5420677288C624E67542F230DA34"
   "0D1E9B8DC5A190B69BF5E67E77929250A802F07CDF0716DB567209774367AAE32E0C1E90928F61C43EAA372F1E9EC70AA0"
   "DD506734D23825213EDAF184A24A1BB128811DB664783CB27CAC1EDD074D79D1259F84DA9E0E5C75923A4DBFAA8A6283DD"
   "2279BA69BCD1D78970D7A54A0D31C44071CBF05527010E2FF808CADEFD74D906A8AD8C32A01845D3AD78BC6ED96A688DFF"
   "F171D80D931409D94C83DA2BC54AD9790E9A6BA5093384850090A961572F6FDB929A1A6BAA98C015E95B0A6DA10DE04B84"
   "71C1AEAC19B6C887C1C81DAD641D55AB1A29250D14DC41A042F83EB8A6BDDCB662A93E00CF6ADAED95CB52B36692F43A8E"
   "9B85BA7723D70E5ADA851A16FE102EE1C6D3BF8BE1634ADE9FA6B44626C734788B3AED0C287AB7E80AE5FC1451DDB037C0"
   "F729309209226022F13E6F8AA592445DB33BB1F29101E0DF15DB15DF0BAB64115BC12F0BBF430551473DBD274DB2EEA990"
   "5EAB75F290ECBD903B675F1AD9AC2F2196D00139E7671AC8B95A8CC8E244511D481863B509E5BB7573B6CE49CF0FC953DE"
   "75523CA31A64012D11BB7F60F1F67B199A4F2013F6EA3808E2639EB5F2631C19568BCF36071235DE8AE7B2D5815E2E0A2E"
   "81098A6B4D6179E29ED0A92BDF585A2905F0496BA58EB3D740EFA54B664D1A6134FED9FEDE636504AA691E08E4";
   EXPECT_EQ(out, Digest::hexDigest(R->generateKeystream()));
}

#endif